<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GeoScan - Decipher the Earth from Above</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            height: 100%;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #121212;
            color: #FFFFFF;
            line-height: 1.6;
            min-height: 100%;
            display: flex;
            flex-direction: column;
        }

        .main-content {
            flex: 1 0 auto;
        }

        /* Hero Section */
        .hero {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 2rem;
            position: relative;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 1440 810"><rect width="100%" height="100%" fill="%23121212" /><defs><radialGradient id="grad1" cx="50%" cy="50%" r="50%" fx="50%" fy="50%"><stop offset="0%" style="stop-color:%2300e0c7;stop-opacity:0.2" /><stop offset="100%" style="stop-color:%23121212;stop-opacity:0" /></radialGradient></defs><rect width="100%" height="100%" fill="url(%23grad1)" /><circle cx="720" cy="405" r="300" stroke="%2300e0c7" stroke-width="1" fill="none" opacity="0.1" /><circle cx="720" cy="405" r="350" stroke="%2364ffda" stroke-width="0.5" fill="none" opacity="0.1" /></svg>');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 400"><circle cx="200" cy="200" r="180" fill="none" stroke="%2300E0C7" stroke-width="2" opacity="0.1"/><circle cx="200" cy="200" r="120" fill="none" stroke="%2364FFDA" stroke-width="1" opacity="0.15"/></svg>') center/400px 400px no-repeat;
            animation: rotate 60s linear infinite;
            z-index: 1;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .hero-content {
            position: relative;
            z-index: 2;
            max-width: 800px;
        }

        .hero h1 {
            font-size: clamp(2.5rem, 5vw, 4rem);
            font-weight: 700;
            margin-bottom: 1.5rem;
            background: linear-gradient(135deg, #FFFFFF 0%, #00E0C7 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero p {
            font-size: clamp(1.1rem, 2.5vw, 1.3rem);
            color: #B0B0B0;
            margin-bottom: 2.5rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .cta-button {
            display: inline-block;
            background: linear-gradient(135deg, #00E0C7 0%, #64FFDA 100%);
            color: #121212;
            padding: 1rem 2.5rem;
            font-size: 1.1rem;
            font-weight: 600;
            text-decoration: none;
            border-radius: 50px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(0, 224, 199, 0.3);
        }

        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(0, 224, 199, 0.5);
        }

        /* How It Works Section */
        .how-it-works {
            padding: 6rem 2rem;
            background-color: #1E1E1E;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .section-title {
            text-align: center;
            font-size: clamp(2rem, 4vw, 2.5rem);
            font-weight: 700;
            margin-bottom: 4rem;
        }

        .steps-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 3rem;
            margin-top: 3rem;
        }

        .step-card {
            text-align: center;
            padding: 2.5rem 2rem;
            background-color: #1a1a1a;
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.01);
            transition: all 0.3s ease;
        }

        .step-card:hover {
            transform: translateY(-5px);
            background-color: #1E1E1E;
            border-color: rgba(0, 224, 199, 0.3);
            box-shadow: 0 10px 30px rgba(0, 224, 199, 0.1);
        }

        .step-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 1.5rem;
            background: rgba(0, 224, 199, 0.1);
            border: 2px solid rgba(0, 224, 199, 0.3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: #00E0C7;
        }

        .step-card h3 {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #FFFFFF;
        }

        .step-card p {
            color: #B0B0B0;
            font-size: 1rem;
            line-height: 1.6;
        }

        /* Main Tool Section */
        .tool-section {
            padding: 6rem 2rem;
            background-color: #121212;
        }

        .tool-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            margin-top: 3rem;
        }

        @media (max-width: 768px) {
            .tool-grid {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
        }

        .upload-panel {
            background-color: #1E1E1E;
            border-radius: 16px;
            padding: 3rem;
            border: 2px dashed rgba(0, 224, 199, 0.3);
            transition: all 0.3s ease;
            position: relative;
            min-height: 400px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .upload-panel.dragover {
            border-color: #00E0C7;
            background-color: rgba(0, 224, 199, 0.05);
        }

        .upload-icon {
            width: 80px;
            height: 80px;
            margin-bottom: 2rem;
            background: linear-gradient(135deg, #00E0C7 0%, #64FFDA 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: #121212;
        }

        .upload-text {
            font-size: 1.2rem;
            margin-bottom: 1.5rem;
            color: #FFFFFF;
        }

        .upload-subtext {
            font-size: 0.9rem;
            color: #B0B0B0;
            margin-bottom: 2rem;
        }

        .browse-btn {
            background: transparent;
            color: #00E0C7;
            border: 2px solid rgba(0, 224, 199, 0.4);
            padding: 0.8rem 2rem;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .browse-btn:hover {
            background: transparent;
            color: #00E0C7;
            border: 2px solid #00E0C7;
            box-shadow: 0 0 15px rgba(0, 224, 199, 0.2);
            transform: translateY(-2px);
        }

        #file-input {
            display: none;
        }

        .results-panel {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .result-card {
            background-color: #1E1E1E;
            border-radius: 16px;
            padding: 2rem;
            border: 1px solid rgba(0, 224, 199, 0.1);
        }

        .primary-result {
            text-align: center;
            padding: 3rem 2rem;
        }

        .result-label {
            font-size: 0.9rem;
            color: #B0B0B0;
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .result-value {
            font-size: 3rem;
            font-weight: 700;
            color: #00E0C7;
            margin-bottom: 0.5rem;
        }

        .result-subtitle {
            color: #B0B0B0;
            font-size: 1rem;
        }

        .detailed-analysis h4 {
            color: #00E0C7;
            font-size: 1.2rem;
            margin-bottom: 1rem;
        }

        .detailed-analysis p {
            color: #B0B0B0;
            line-height: 1.6;
        }

        /* Message Box */
        .message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #2D3748;
            color: white;
            padding: 15px 30px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            pointer-events: none;
        }

        .message-box.visible {
            opacity: 1;
        }

        /* Examples Section */
        .examples {
            padding: 6rem 2rem;
            background-color: #1E1E1E;
        }

        .examples-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .example-card {
            background-color: #121212;
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid rgba(0, 224, 199, 0.1);
            transition: all 0.3s ease;
        }

        .example-card:hover {
            transform: translateY(-5px);
            border-color: rgba(0, 224, 199, 0.3);
        }

        .example-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .example-content {
            padding: 1.5rem;
        }

        .example-tag {
            display: inline-block;
            background: rgba(0, 224, 199, 0.2);
            color: #00E0C7;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .example-content p {
            color: #B0B0B0;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        /* Footer */
        .footer {
            flex-shrink: 0;
            background-color: #121212;
            padding: 2rem;
            text-align: center;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 2rem;
        }

        .footer-content {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
            font-family: 'Inter', sans-serif;
            font-size: 0.9rem;
            color: #B0B0B0;
        }
        footer:last-of-type {
            display: none !important;
        }

        .github-link {
            display: inline-flex;
            align-items: center;
            color: #B0B0B0;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .github-link:hover {
            color: #FFFFFF;
        }

        .github-icon {
            width: 16px;
            height: 16px;
            margin-left: 0.3rem;
        }

        .linkedin-link {
            display: inline-flex;
            align-items: center;
            color: #0077B5;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .linkedin-link:hover {
            color: #005E99;
        }

        .linkedin-icon {
            width: 16px;
            height: 16px;
            margin-left: 0.3rem;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .hero {
                min-height: 80vh;
                padding: 1rem;
            }

            .how-it-works, .tool-section, .examples {
                padding: 4rem 1rem;
            }

            .upload-panel {
                padding: 2rem;
                min-height: 300px;
            }

            .result-value {
                font-size: 2rem;
            }

            .examples-grid {
                grid-template-columns: 1fr;
            }

            .footer-content {
                font-size: 0.8rem;
            }

            .github-icon, .linkedin-icon {
                width: 14px;
                height: 14px;
            }

            #example-dropdown {
                width: 70%;
                padding: 0.5rem;
                margin: 1rem auto 0;
                border: 2px solid rgba(0, 224, 199, 0.3);
                background-color: #1a1a1a;
                color: #00E0C7;
                border-radius: 8px;
                font-size: 0.9rem;
                font-family: 'Inter', sans-serif;
                cursor: pointer;
                appearance: none;
                -webkit-appearance: none;
                background-image: url('data:image/svg+xml;charset=utf-8,%3Csvg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="%2300E0C7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"%3E%3Cpath d="M6 9l6 6 6-6"/%3E%3C/svg%3E');
                background-repeat: no-repeat;
                background-position: right 10px center;
                background-size: 12px;
            }

            #example-dropdown:focus {
                outline: none;
                border-color: #00E0C7;
                box-shadow: 0 0 0 2px rgba(0, 224, 199, 0.3);
            }
        }
    </style>
</head>
<body>
    <div id="message-box" class="message-box"></div>

    <main class="main-content">
        <section class="hero">
            <div class="hero-content">
                <h1>Decipher the Earth from Above</h1>
                <p>Our AI algorithms process your satellite images to identify key features and patterns with unprecedented accuracy.</p>
                <a href="#tool" class="cta-button">Try It Now</a>
            </div>
        </section>

        <section class="how-it-works">
            <div class="container">
                <h2 class="section-title">How It Works</h2>
                <div class="steps-grid">
                    <div class="step-card">
                        <div class="step-icon">📤</div>
                        <h3>Upload</h3>
                        <p>Securely upload your satellite imagery for processing and analysis.</p>
                    </div>
                    <div class="step-card">
                        <div class="step-icon">🔍</div>
                        <h3>Analyze</h3>
                        <p>Our AI-powered engine processes and classifies geographical features.</p>
                    </div>
                    <div class="step-card">
                        <div class="step-icon">📍</div>
                        <h3>Discover</h3>
                        <p>Receive detailed insights and classifications of geographical features.</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="tool-section" id="tool">
            <div class="container">
                <h2 class="section-title">AI Image Analysis Tool</h2>
                <div class="tool-grid">
                    <div class="upload-panel" id="upload-area">
                        <div class="upload-icon">☁️</div>
                        <div class="upload-text">Upload Your Image</div>
                        <div class="upload-subtext">Drag and drop your satellite image here<br>or click to browse files</div>
                        <button class="browse-btn">Browse Files</button>
                        <input type="file" id="file-input" accept="image/*" />
                    </div>

                    <div class="results-panel">
                        <div class="result-card primary-result">
                            <div class="result-label">Analysis Results</div>
                            <div class="result-value" id="primary-result">N/A</div>
                            <div class="result-subtitle">Primary terrain classification detected by AI</div>
                        </div>

                        <div class="result-card">
                            <h4>Detailed Analysis</h4>
                            <p id="detailed-analysis">Upload an image to get a comprehensive analysis of the geographical features.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="examples">
            <div class="container">
                <h2 class="section-title">Example Analyses</h2>
                <div class="examples-grid">
                    <div class="example-card">
                        <img src="https://placehold.co/350x200/E5E7EB/4B5563?text=Coastal" alt="Coastal terrain" class="example-image">
                        <div class="example-content">
                            <span class="example-tag">COASTAL</span>
                            <p>The analysis reveals a distinct coastline with sandy beaches, shallow waters, and coastal vegetation. The AI indicates active sedimentary processes like erosion and deposition along the shoreline.</p>
                        </div>
                    </div>
                    <div class="example-card">
                        <img src="https://placehold.co/350x200/E5E7EB/4B5563?text=Urban" alt="Urban terrain" class="example-image">
                        <div class="example-content">
                            <span class="example-tag">URBAN</span>
                            <p>Deep analysis reveals a dense urban landscape, with a high concentration of buildings, roads, and other man-made structures. The area is highly developed with little natural vegetation.</p>
                        </div>
                    </div>
                    <div class="example-card">
                        <img src="https://placehold.co/350x200/E5E7EB/4B5563?text=Forest" alt="Forest terrain" class="example-image">
                        <div class="example-content">
                            <span class="example-tag">FOREST</span>
                            <p>Identifies a dense forested area characterized by a healthy canopy and a river system, indicating rich biodiversity and stable ecosystem.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="footer-content">
            <p>Built with Python, TensorFlow</p>
            <p>&copy; 2025 GeoScan. All rights reserved.</p>
            <a href="https://github.com/tanishqkr" class="github-link" target="_blank" rel="noopener noreferrer">
                <svg class="github-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                </svg>
            </a>
            <a href="https://www.linkedin.com/in/tanishporwal" class="linkedin-link" target="_blank" rel="noopener noreferrer">
                <svg class="linkedin-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                </svg>
            </a>
        </div>
    </footer>

    <script>
        // Global utility to show messages
        function showMessage(text, duration = 3000) {
            const messageBox = document.getElementById('message-box');
            messageBox.textContent = text;
            messageBox.classList.add('visible');
            setTimeout(() => {
                messageBox.classList.remove('visible');
            }, duration);
        }

        // File upload functionality
        const uploadArea = document.getElementById('upload-area');
        const fileInput = document.getElementById('file-input');
        const primaryResult = document.getElementById('primary-result');
        const detailedAnalysis = document.getElementById('detailed-analysis');
        
        // This is the correct way to get the URL dynamically
        const backendUrl = "https://satellite-image-classifier.onrender.com";

        // Reset upload panel to initial state
        function resetUploadPanel() {
            const uploadIcon = uploadArea.querySelector('.upload-icon');
            const uploadText = uploadArea.querySelector('.upload-text');
            const uploadSubtext = uploadArea.querySelector('.upload-subtext');
            const browseBtn = uploadArea.querySelector('.browse-btn');
            const existingImg = uploadArea.querySelector('img');

            if (existingImg) uploadArea.removeChild(existingImg);
            uploadIcon.textContent = '☁️';
            uploadText.textContent = 'Upload Your Image';
            uploadSubtext.textContent = 'Drag and drop your satellite image here or click to browse files';
            browseBtn.textContent = 'Browse Files';
        }

        // Example Images Configuration (with public URLs)
        const exampleImages = {
            'Annual Crop': 'https://placehold.co/350x200/E5E7EB/4B5563?text=Annual+Crop',
            'Forest': 'https://placehold.co/350x200/E5E7EB/4B5563?text=Forest',
            'River': 'https://placehold.co/350x200/E5E7EB/4B5563?text=River',
            'Urban': 'https://placehold.co/350x200/E5E7EB/4B5563?text=Urban',
            'Sea / Lake': 'https://placehold.co/350x200/E5E7EB/4B5563?text=Sea+%2F+Lake'
        };

        // Build Dropdown and Insert into Upload Panel
        function setupExampleDropdown() {
            const select = document.createElement('select');
            select.id = 'example-dropdown';
            select.style.width = '70%';
            select.style.padding = '0.5rem';
            select.style.margin = '1rem auto 0';
            select.style.border = '2px solid rgba(0, 224, 199, 0.3)';
            select.style.backgroundColor = '#1a1a1a';
            select.style.color = '#00E0C7';
            select.style.borderRadius = '8px';
            select.style.fontSize = '0.9rem';
            select.style.fontFamily = 'Inter, sans-serif';
            select.style.cursor = 'pointer';
            select.style.appearance = 'none';
            select.style.backgroundImage = 'url("data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'12\' height=\'12\' viewBox=\'0 0 24 24\' fill=\'none\' stroke=\'%2300E0C7\' stroke-width=\'2\' stroke-linecap=\'round\' stroke-linejoin=\'round\'%3E%3Cpath d=\'M6 9l6 6 6-6\'/%3E%3C/svg%3E")';
            select.style.backgroundRepeat = 'no-repeat';
            select.style.backgroundPosition = 'right 10px center';
            select.style.backgroundSize = '12px';

            select.innerHTML = `
                <option value="">Choose an example image...</option>
                ${Object.entries(exampleImages)
                    .map(([name, path]) => `<option value="${path}">${name}</option>`)
                    .join('')}
            `;

            select.addEventListener('change', async function () {
                const selectedPath = this.value;
                if (!selectedPath) return;

                try {
                    const response = await fetch(selectedPath);
                    if (!response.ok) throw new Error('Image not found');

                    const blob = await response.blob();
                    const file = new File([blob], selectedPath.split('/').pop(), {
                        type: 'image/jpeg'
                    });

                    this.value = '';

                    handleFile(file);
                } catch (error) {
                    console.error('Failed to load example image:', error);
                    showMessage('Failed to load example image. Please try again.');
                }
            });

            const browseBtn = uploadArea.querySelector('.browse-btn');
            uploadArea.insertBefore(select, browseBtn.nextSibling);
        }

        // Handle File Selection and Send to Backend
        async function handleFile(file) {
            console.log('Handling file:', file);
            resetUploadPanel();

            if (!file.type.startsWith('image/')) {
                showMessage('Please select a valid image file.');
                return;
            }

            const img = new Image();
            img.src = URL.createObjectURL(file);
            img.style.maxWidth = '100%';
            img.style.maxHeight = '200px';
            img.style.margin = '1rem auto';
            img.style.display = 'block';

            const uploadIcon = uploadArea.querySelector('.upload-icon');
            const uploadText = uploadArea.querySelector('.upload-text');
            const uploadSubtext = uploadArea.querySelector('.upload-subtext');
            const browseBtn = uploadArea.querySelector('.browse-btn');

            uploadIcon.textContent = '✓';
            uploadText.textContent = 'Image Uploaded Successfully';
            uploadSubtext.textContent = file.name;
            browseBtn.textContent = 'Upload Another';

            uploadArea.insertBefore(img, browseBtn);

            primaryResult.textContent = 'Analyzing...';
            detailedAnalysis.textContent = 'Please wait while the AI processes your image.';
            primaryResult.style.opacity = '1';
            detailedAnalysis.style.opacity = '1';

            try {
                const formData = new FormData();
                formData.append('file', file);

                // Updated fetch call using a relative path
                const response = await fetch(`${backendUrl}/predict`, {
                    method: 'POST',
                    body: formData,
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || `Analysis failed with status: ${response.status}`);
                }

                const data = await response.json();
                console.log('Prediction results:', data);

                primaryResult.style.opacity = '0.5';
                detailedAnalysis.style.opacity = '0.5';

                setTimeout(() => {
                    primaryResult.textContent = data.class;
                    detailedAnalysis.textContent = data.description;
                    primaryResult.style.opacity = '1';
                    detailedAnalysis.style.opacity = '1';
                }, 300);

            } catch (error) {
                console.error('Error during API call:', error);
                primaryResult.textContent = 'ERROR';
                detailedAnalysis.textContent = error.message;
                resetUploadPanel();
                showMessage('Analysis failed. Please check the console for details.', 5000);
            }
        }

        // Initialize on DOM Load
        window.addEventListener('DOMContentLoaded', () => {
            console.log('DOM fully loaded, setting up listeners');

            // Setup Example Dropdown
            setupExampleDropdown();

            // Drag and Drop Events
            uploadArea.addEventListener('dragover', (e) => {
                console.log('Drag over detected');
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });

            uploadArea.addEventListener('dragleave', () => {
                console.log('Drag leave detected');
                uploadArea.classList.remove('dragover');
            });

            uploadArea.addEventListener('drop', (e) => {
                console.log('Drop detected');
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    resetUploadPanel();
                    handleFile(files[0]);
                }
            });

            // File Input Change
            fileInput.addEventListener('change', (e) => {
                console.log('File input changed');
                if (e.target.files.length > 0) {
                    resetUploadPanel();
                    handleFile(e.target.files[0]);
                }
            });

            // Browse Button Click
            document.querySelector('.browse-btn').addEventListener('click', (e) => {
                console.log('Browse button clicked');
                e.stopPropagation();
                fileInput.click();
            });

            console.log('All listeners attached');
        });

        // Smooth Scrolling for CTA Button
        document.querySelector('.cta-button').addEventListener('click', (e) => {
            e.preventDefault();
            document.getElementById('tool').scrollIntoView({
                behavior: 'smooth'
            });
        });

        // Scroll Animations
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);

        document.querySelectorAll('.step-card, .example-card').forEach(el => {
            el.style.opacity = '0';
            el.style.transform = 'translateY(20px)';
            el.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
            observer.observe(el);
        });
    </script>
</body>
</html>
